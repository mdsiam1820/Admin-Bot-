module.exports.config = {
  name: "message",
  version: "1.0.0",
  hasPermssion: 0,
  credits: "тАФ═Я═Я═Ю═ЮЁЭРВЁЭРШЁЭРБЁЭРДЁЭРС тШвя╕П_ЁЦгШ -ЁЭРБЁЭРОЁЭРУ тЪая╕П ЁЭС╗ЁЭСмЁЭСиЁЭС┤_ тШвя╕П",
  description: "ржПржХржЯрж┐ ржХрж╛рж╕рзНржЯржо ржПрж╕ржПржоржПрж╕ ржкрж╛ржарж╛ржи (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рж┐ ржирж╛ржорзНржмрж╛рж░рзЗ)",
  commandCategory: "Tool",
  usages: "/message 01xxxxxxxxx [text]",
  cooldowns: 5,
  dependencies: { "axios": "" }
};

const axios = require("axios");

module.exports.run = async ({ api, event, args }) => {
  const threadID = event.threadID;
  
  // рж╣рзЗрж▓рзНржк ржорзЗрж╕рзЗржЬ
  if (args[0] === "help" || args.length === 0) {
    return api.sendMessage(
      "тХнтАвтФДтФЕтХРтХРтХРтХРтЭАЁЯМ║тЭАтХРтХРтХРтХРтФЕтФДтАвтХо\n\n" +
      "ЁЯУд *ржПрж╕ржПржоржПрж╕ рж╕рзЗржирзНржбрж╛рж░ (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢)*\n\n" +
      "тЪб *ржХржорж╛ржирзНржб:* `/message 01xxxxxxxxx [ржорзЗрж╕рзЗржЬ]`\n\n" +
      "ЁЯУМ *ржЙржжрж╛рж╣рж░ржг:*\n" +
      "`/message 01712345678 рж╣рзНржпрж╛рж▓рзЛ ржнрж╛ржЗ, ржХрзЗржоржи ржЖржЫрзЗржи?`\n\n" +
      "тЪая╕П *ржирзЛржЯ:* рж╢рзБржзрзБржорж╛рждрзНрж░ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рж┐ ржирж╛ржорзНржмрж╛рж░рзЗ ржХрж╛ржЬ ржХрж░рзЗ (01xxxxxxxxx)\n\n" +
      "тХ░тАвтФДтФЕтХРтХРтХРтХРтЭАЁЯМ║тЭАтХРтХРтХРтХРтФЕтФДтАвтХп",
      threadID
    );
  }

  const number = args[0];
  const message = args.slice(1).join(" ") || "тАФ═Я═Я═Ю═ЮЁЭРВЁЭРШЁЭРБЁЭРДЁЭРС тШвя╕П_ЁЦгШ -ЁЭРБЁЭРОЁЭРУ тЪая╕П ЁЭС╗ЁЭСмЁЭСиЁЭС┤_ тШвя╕П ржжрзНржмрж╛рж░рж╛ ржкрж╛ржарж╛ржирзЛ ржмрж╛рж░рзНрждрж╛";

  // ржирж╛ржорзНржмрж╛рж░ ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи (01 ржжрж┐рзЯрзЗ рж╢рзБрж░рзБ, 11 ржбрж┐ржЬрж┐ржЯ)
  if (!number || !/^01[0-9]{9}$/.test(number)) {
    return api.sendMessage("тЭМ *ржнрзБрж▓ ржирж╛ржорзНржмрж╛рж░!* рж╕ржарж┐ржХ ржлрж░ржорзНржпрж╛ржЯ:\n`/message 01xxxxxxxxx [ржорзЗрж╕рзЗржЬ]`", threadID);
  }

  try {
    // SMS API рж░рж┐ржХрзЛрзЯрзЗрж╕рзНржЯ
    const encodedMessage = encodeURIComponent(message);
    await axios.get(`https://custom-sms.wuaze.com/index.php?number=${number}&message=${encodedMessage}`);
    
    // рж╕рж╛ржХрж╕рзЗрж╕ ржорзЗрж╕рзЗржЬ
    return api.sendMessage(
      "тХнтАвтФДтФЕтХРтХРтХРтХРтЭАЁЯМ║тЭАтХРтХРтХРтХРтФЕтФДтАвтХо\n\n" +
      "тЬЕ *ржПрж╕ржПржоржПрж╕ рж╕ржлрж▓ржнрж╛ржмрзЗ ржкрж╛ржарж╛ржирзЛ рж╣рзЯрзЗржЫрзЗ!*\n\n" +
      `ЁЯУ▒ *ржиржорзНржмрж░:* ${number}\n` +
      `тЬЙя╕П *ржорзЗрж╕рзЗржЬ:* "${message}"\n\n` +
      "тХ░тАвтФДтФЕтХРтХРтХРтХРтЭАЁЯМ║тЭАтХРтХРтХРтХРтФЕтФДтАвтХп",
      threadID
    );
  } catch (err) {
    return api.sendMessage("тЭМ *ржПрж╕ржПржоржПрж╕ ржкрж╛ржарж╛рждрзЗ рж╕ржорж╕рзНржпрж╛!* (" + err.message + ")", threadID);
  }
};
